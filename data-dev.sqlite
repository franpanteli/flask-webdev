--- flask shell
--- from app import db
--- db.create_all()
--- exit()

-- SQLite format 3 (for data-dev.sqlite)

-- Create the 'roles' table
CREATE TABLE roles (
    id INTEGER NOT NULL,  -- Primary Key for roles
    name VARCHAR(64),     -- Role name (unique)
    PRIMARY KEY (id),     -- Set 'id' as the primary key
    UNIQUE (name)         -- Ensure role names are unique
);

-- Create the 'users' table
CREATE TABLE users (
    id INTEGER NOT NULL,  -- Primary Key for users
    username VARCHAR(64), -- Username (unique and indexed)
    role_id INTEGER,      -- Foreign key linking to 'roles' table
    PRIMARY KEY (id),     -- Set 'id' as the primary key
    FOREIGN KEY(role_id) REFERENCES roles (id), -- Foreign key constraint
    UNIQUE (username)     -- Ensure usernames are unique
);

-- Create an index for fast username lookups
CREATE INDEX ix_users_username ON users (username);